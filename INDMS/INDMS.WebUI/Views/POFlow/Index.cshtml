@model INDMS.WebUI.ViewModels.POFlowViewModel
@{
    ViewBag.Title = "PO Timeline";
}

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            PO Timeline - @Model.PO.PONo
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i>PO</a></li>
            <li class="active">Time-line</li>
        </ol>
    </section>
    <!-- Main content -->
    <section class="content">

        <!-- row -->
        <div class="row">
            <div class="col-md-12">
                @if (TempData["MSG"] != null)
                {
                    <div class="alert alert-success alert-dismissable">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                        @TempData["MSG"]
                    </div>
                }
                @if (TempData["Error"] != null)
                {
                    <div class="alert alert-danger alert-dismissable">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                        @TempData["Error"]
                    </div>
                }
                <!-- The time line -->

                <ul class="timeline">
                    @*--------------------------------I Note Start---------------------------------*@
                    @if ((Model.POGeneration.I_NOTE ?? 0) == 1)
                    {
                        if (Model.CoveringLetters.Count() > 0)
                        {
                            <li>
                                <i class="fa fa-envelope bg-aqua"></i>
                                <div class="timeline-item">
                                    <h3 class="timeline-header">
                                        @Html.ActionLink("Add I-Note /FORM 4", "New", "INOTE", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                    </h3>
                                    <div class="timeline-body">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="box">
                                                    <div class="box-header">
                                                    </div><!-- /.box-header -->
                                                    <div class="box-body">
                                                        <table class="table table-bordered table-striped">
                                                            <thead>
                                                                <tr>
                                                                    <td>
                                                                        Po No
                                                                    </td>
                                                                    <td>
                                                                        File No
                                                                    </td>
                                                                    <td>
                                                                        Date
                                                                    </td>
                                                                    <td>
                                                                        No. Of Lots
                                                                    </td>
                                                                    <td>
                                                                        PO Value
                                                                    </td>
                                                                    <td>
                                                                        Warantee / Gurantee
                                                                    </td>

                                                                    <td></td>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                @foreach (var item in Model.CoveringLetters)
                                                                {
                                                                    <tr>
                                                                        <td>
                                                                            @item.PONo
                                                                        </td>
                                                                        <td>
                                                                            @item.FileNo
                                                                        </td>
                                                                        <td>
                                                                            @if (!Convert.ToString(item.Date).Equals(""))
                                                                            {
                                                                                @Convert.ToString(item.Date).Substring(0, 9);
                                                                            }
                                                                    
                                                                        </td>
                                                                        <td>
                                                                            @item.NoOfLots
                                                                        </td>
                                                                        <td>
                                                                            @item.POValue
                                                                        </td>
                                                                        <td>
                                                                            @item.Warantee
                                                                        </td>
                                                                        <td>
                                                                            @Html.ActionLink(" ", "Edit", "INOTE", new { @id = item.Id }, new { @class = "fa fa-edit", @title = "Edit" }) |

                                                                            @*<a href="@item.FilePath" target="_blank" class="fa fa-folder-open-o" title="Open"></a>*@
                                                                        </td>
                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="timeline-footer"></div>
                                </div>
                            </li>
                        }
                        else
                        {
                            <li>
                                <i class="fa fa-envelope bg-aqua"></i>
                                <div class="timeline-item">
                                    <h3 class="timeline-header">
                                        @Html.ActionLink("Add I-Note / Form 4", "New", "Drawing", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                    </h3>
                                    <div class="timeline-body"></div>
                                    <div class="timeline-footer"></div>
                                </div>
                            </li>
                        }
                    }

                    @*--------------------------------I Note End-----------------------------------*@
                        @*--------------------------------QAP Start---------------------------------*@
                        @if ((Model.POGeneration.QAP ?? 0) == 1)
                        {
                            if (Model.QAPs.Count() > 0)
                            {
                                <li>
                                    <i class="fa fa-envelope bg-aqua"></i>
                                    <div class="timeline-item">
                                        <h3 class="timeline-header">
                                            @Html.ActionLink("Add QAP", "New", "QAP", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                        </h3>
                                        <div class="timeline-body">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="box">
                                                        <div class="box-header">
                                                        </div><!-- /.box-header -->
                                                        <div class="box-body">
                                                            <table class="table table-bordered table-striped">
                                                                <thead>
                                                                    <tr>
                                                                        <td>
                                                                            Po No
                                                                        </td>
                                                                        <td>
                                                                            File No
                                                                        </td>
                                                                        <td>
                                                                            QAP No
                                                                        </td>
                                                                        <td>
                                                                            QAP Description
                                                                        </td>
                                                                        <td>
                                                                            Approval Date
                                                                        </td>
                                                                        <td>
                                                                            Approval By
                                                                        </td>
                                                                        <td>
                                                                            Drawing No. Reference
                                                                        </td>
                                                                        <td></td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @foreach (var item in Model.QAPs)
                                                                    {
                                                                        <tr>
                                                                            <td>@item.PONo</td>
                                                                            <td>
                                                                                @item.FileNo
                                                                            </td>
                                                                            <td>
                                                                                @item.QAPNo
                                                                            </td>
                                                                            <td>
                                                                                @item.Subject
                                                                            </td>
                                                                            <td>
                                                                                @if (!Convert.ToString(item.ApprovalDate).Equals(""))
                                                                                {
                                                                                    @Convert.ToString(item.ApprovalDate).Substring(0, 9);
                                                                                }
                                                                  
                                                                            </td>
                                                                            <td>
                                                                                @item.ApprovedBy
                                                                            </td>
                                                                            <td>
                                                                                @item.DrawingNoRef
                                                                            </td>
                                                                            <td>
                                                                                @Html.ActionLink(" ", "Edit", "QAP", new { @id = item.Id }, new { @class = "fa fa-edit", @title = "Edit" }) |

                                                                                <a href="@item.FilePath" target="_blank" class="fa fa-folder-open-o" title="Open"></a>
                                                                            </td>
                                                                        </tr>
                                                                    }
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="timeline-footer"></div>
                                    </div>
                                </li>
                            }
                            else
                            {
                                <li>
                                    <i class="fa fa-envelope bg-aqua"></i>
                                    <div class="timeline-item">
                                        <h3 class="timeline-header">
                                            @Html.ActionLink("Add New QAP", "New", "QAP", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                        </h3>
                                        <div class="timeline-body"></div>
                                        <div class="timeline-footer"></div>
                                    </div>
                                </li>
                            }
                        }

                        @*--------------------------------QAP End---------------------------------*@

                            @*--------------------------------Drawing Start---------------------------------*@
                            @if ((Model.POGeneration.DRAWING ?? 0) == 1)
                            {
                                if (Model.Drawings.Count() > 0)
                                {

                                    <li>
                                        <i class="fa fa-envelope bg-aqua"></i>
                                        <div class="timeline-item">
                                            <h3 class="timeline-header">
                                                @Html.ActionLink("Add Drawings", "New", "Drawing", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                            </h3>
                                            <div class="timeline-body">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="box">
                                                            <div class="box-header">
                                                            </div><!-- /.box-header -->
                                                            <div class="box-body">
                                                                <table class="table table-bordered table-striped">
                                                                    <thead>
                                                                        <tr>
                                                                            <td>
                                                                                Po Name
                                                                            </td>
                                                                            <td>
                                                                                File No
                                                                            </td>
                                                                            <td>
                                                                                Drawing No
                                                                            </td>
                                                                            <td>
                                                                                Description
                                                                            </td>
                                                                            <td>
                                                                                Approval Date
                                                                            </td>
                                                                            <td>
                                                                                Approval By
                                                                            </td>
                                                                            <td></td>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @foreach (var item in Model.Drawings)
                                                                        {
                                                                            <tr>
                                                                                <td>@item.PONo</td>
                                                                                <td>
                                                                                    @item.FileNo
                                                                                </td>
                                                                                <td>
                                                                                    @item.DrawingNo
                                                                                </td>
                                                                                <td>
                                                                                    @item.Subject
                                                                                </td>
                                                                                <td>
                                                                                    @if (!Convert.ToString(item.ApprovalDate).Equals(""))
                                                                                    {
                                                                                        @Convert.ToString(item.ApprovalDate).Substring(0, 9);
                                                                                    }
                                                                                </td>
                                                                                <td>
                                                                                    @item.ApprovalBy
                                                                                </td>

                                                                                <td>
                                                                                    @Html.ActionLink(" ", "Edit", "Drawing", new { @id = item.Id }, new { @class = "fa fa-edit", @title = "Edit" }) |

                                                                                    <a href="@item.FilePath" target="_blank" class="fa fa-folder-open-o" title="Open"></a>
                                                                                </td>
                                                                            </tr>
                                                                        }
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="timeline-footer"></div>
                                        </div>
                                    </li>
                                }
                                else
                                {
                                    <li>
                                        <i class="fa fa-envelope bg-aqua"></i>
                                        <div class="timeline-item">
                                            <h3 class="timeline-header">
                                                @Html.ActionLink("Add New Drawing", "New", "Drawing", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                            </h3>
                                            <div class="timeline-body"></div>
                                            <div class="timeline-footer"></div>
                                        </div>
                                    </li>
                                }
                            }
                            @*--------------------------------Drawing End---------------------------------*@
                                @*--------------------------------POCorrespondence Start---------------------------------*@
                                @if ((Model.POGeneration.PO_CORRESPONDENCE ?? 0) == 1)
                                {
                                    if (Model.POCorrespondences.Count() > 0)
                                    {

                                        <li>
                                            <i class="fa fa-envelope bg-aqua"></i>
                                            <div class="timeline-item">
                                                <h3 class="timeline-header">
                                                    @Html.ActionLink("Add PO Correspondence", "New", "POCorrespondence", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                                </h3>
                                                <div class="timeline-body">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="box">
                                                                <div class="box-header">
                                                                </div><!-- /.box-header -->
                                                                <div class="box-body">
                                                                    <table class="table table-bordered table-striped">
                                                                        <thead>
                                                                            <tr>
                                                                                <td>
                                                                                    Po No
                                                                                </td>
                                                                                <td>
                                                                                    File No
                                                                                </td>
                                                                                <td>
                                                                                    Lettor No
                                                                                </td>
                                                                                <td>
                                                                                    Description
                                                                                </td>
                                                                                <td>
                                                                                    Subject
                                                                                </td>
                                                                                <td>
                                                                                    Type Of Correspondence
                                                                                </td>
                                                                                <td>
                                                                                    From
                                                                                </td>
                                                                                <td>
                                                                                    To
                                                                                </td>
                                                                                <td>
                                                                                    Copy To
                                                                                </td>
                                                                                <td>
                                                                                    Date
                                                                                </td>
                                                                        
                                                                                <td></td>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @foreach (var item in Model.POCorrespondences)
                                                                            {
                                                                                <tr>
                                                                                    <td>@item.PONo</td>
                                                                                    <td>
                                                                                        @item.FileNo
                                                                                    </td>
                                                                                    <td>
                                                                                        @item.LetterNo
                                                                                    </td>
                                                                                    <td>
                                                                                        @item.Description
                                                                                    </td>
                                                                                    <td>
                                                                                        @item.Subject
                                                                                    </td>
                                                                                    <td>
                                                                                        @item.TypeOfCorrespondence
                                                                                    </td>
                                                                                    <td>
                                                                                        @item.From
                                                                                    </td>
                                                                                    <td>
                                                                                        @item.To
                                                                                    </td>
                                                                                    <td>
                                                                                        @item.CopyTo
                                                                                    </td>
                                                                                    <td>
                                                                                        @if (!Convert.ToString(item.Date).Equals(""))
                                                                                        {
                                                                                            @Convert.ToString(item.Date).Substring(0, 9);
                                                                                        }
                                                                                   
                                                                                    </td>
                                                                                    <td>
                                                                                        @Html.ActionLink(" ", "Edit", "POCorrespondence", new { @id = item.Id }, new { @class = "fa fa-edit", @title = "Edit" }) |

                                                                                        <a href="@item.FilePath" target="_blank" class="fa fa-folder-open-o" title="Open"></a>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="timeline-footer"></div>
                                            </div>
                                        </li>
                                    }
                                    else
                                    {
                                        <li>
                                            <i class="fa fa-envelope bg-aqua"></i>
                                            <div class="timeline-item">
                                                <h3 class="timeline-header">
                                                    @Html.ActionLink("Add PO Correspondence", "New", "POCorrespondence", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                                </h3>
                                                <div class="timeline-body"></div>
                                                <div class="timeline-footer"></div>
                                            </div>
                                        </li>
                                    }
                                }
                                @*--------------------------------Drawing End---------------------------------*@
                                    @*--------------------------------FCL Start---------------------------------*@
                                    @if ((Model.POGeneration.FCL ?? 0) == 1)
                                    {
                                        if (Model.FCLs.Count() > 0)
                                        {
                                            <li>
                                                <i class="fa fa-envelope bg-aqua"></i>
                                                <div class="timeline-item">
                                                    <h3 class="timeline-header">
                                                        @Html.ActionLink("Add New FCL", "New", "FCL", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                                    </h3>
                                                    <div class="timeline-body">
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <div class="box">
                                                                    <div class="box-header">
                                                                    </div><!-- /.box-header -->
                                                                    <div class="box-body">
                                                                        <table class="table table-bordered table-striped">
                                                                            <thead>
                                                                                <tr>
                                                                                    <td>
                                                                                        Po Name
                                                                                    </td>
                                                                                    <td>
                                                                                        Created Date
                                                                                    </td>
                                                                                    <td></td>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                @foreach (var item in Model.FCLs)
                                                                                {
                                                                                    <tr>
                                                                                        <td>@item.POName</td>
                                                                                        <td>
                                                                                            @if (!Convert.ToString(item.CreatedDate).Equals(""))
                                                                                            {
                                                                                                @Convert.ToString(item.CreatedDate).Substring(0, 9);
                                                                                            }
                                                                                    
                                                                                        </td>
                                                                                        <td>
                                                                                            @if (item.Flag != "ACCEPTED")
                                                                                            {
                                                                                                @Html.ActionLink(" ", "Edit", "FCL", new { @id = item.Id }, new { @class = "fa fa-edit", @title = "Edit" });
                                                                                            }

                                                                                            @Html.ActionLink(" ", "Print", "FCL", new { @id = item.Id }, new { @class = "fa fa-print", @title = "Print" })
                                                                                        </td>
                                                                                    </tr>
                                                                                }
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            @*<div class="form-group col-md-12">
                                                                    <div class="col-md-4">
                                                                        @Html.ActionLink("Edit", "Edit", "FCL", new { @id = Model.FCL.Id }, new { @class = "btn btn-primary" })
                                                                        @Html.ActionLink("Print FCL", "Print", "FCL", new { @id = Model.FCL.Id }, new { @class = "btn btn-primary" })
                                                                    </div>
                                                                </div>*@
                                                        </div>
                                                    </div>
                                                    <div class="timeline-footer"></div>
                                                </div>
                                            </li>
                                        }
                                        else
                                        {
                                            <li>
                                                <i class="fa fa-envelope bg-aqua"></i>
                                                <div class="timeline-item">
                                                    <h3 class="timeline-header">
                                                        @Html.ActionLink("Add New FCL", "New", "FCL", new { @Id = Model.PO.Id }, new { @class = "btn btn-primary" })
                                                    </h3>
                                                    <div class="timeline-body"></div>
                                                    <div class="timeline-footer"></div>
                                                </div>
                                            </li>
                                        }
                                    }
                                    @*--------------------------------FCL End---------------------------------*@

                                    <!-- timeline time label -->
                                    <li class="time-label">
                                        <span class="bg-red">
                                            @{
                                                var poDate = Model.PO.PODate.ToString().Substring(0, 9);
                                            }
                                            @poDate
                                        </span>
                                    </li>
                                    <!-- /.timeline-label -->
                                    <!-- timeline item -->
                                    <li>
                                        <i class="fa fa-envelope bg-blue"></i>
                                        <div class="timeline-item">
                                            <h3 class="timeline-header">New PO Created</h3>
                                            <div class="timeline-body">
                                                <div class="row">
                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "File No", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.FileNo, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "PO No", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.PONo, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "PO Date", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @poDate
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "PO Value", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.POValue, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "Quantity", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.Quantity, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "No. OF Lots", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.NoOfLots, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "Delivery Date", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @{
                                                                var deliveryDate = Model.PO.DeliveryDate.ToString().Substring(0, 9);
                                                            }
                                                            @deliveryDate
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "PO Placing Authority", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.PoPlacingAuthority, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "Nominated Quality Inspector's Name", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.Inspectors, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "Firm Name", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.Firm, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        @Html.Label("", "Firm Address", new { @class = "control-label col-md-2" })
                                                        <div class="col-md-4">
                                                            @Html.DisplayFor(m => m.PO.FirmAddress, new { @class = "control-label col-md-2" })
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="timeline-footer">
                                                <a class="btn btn-primary btn-xs">Read more</a>
                                            </div>
                                        </div>
                                    </li>
                                    <!-- END timeline item -->

                                    <li>
                                        <i class="fa fa-clock-o bg-gray"></i>
                                    </li>
                                </ul>
                            </div><!-- /.col -->
                        </div><!-- /.row -->
                    </section><!-- /.content -->
                </div><!-- /.content-wrapper -->
                @section scripts{
                    <script>
                        $(function () {
                            $('li').removeClass("active");
                            $('#liPo').addClass("active");
                        });
                    </script>
                }